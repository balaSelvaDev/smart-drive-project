<div style="width: 100%;height: 460px;background-color: grey;display: flex;">
    <div
        style="display: flex; justify-content: center; align-items: center;height: 100%;flex-direction: column;width: 100%;border: white 1px solid;">
        <form [formGroup]="locationAndDate">
            <div>
                <h1 style="color: white;">Welcome to the Anonymous Main Page <span style="color: green">Madurai</span>
                </h1>
            </div>
            <div style="width: 400px; margin-top: 20px;">
                <label for="pickup">Pickup location:</label>
                <input type="text" id="pickup" placeholder="Enter a location" class="location-input" formControlName="pickupLocation"
                    style="width: 100%; padding: 10px; box-sizing: border-box; border-radius: 4px; border: 1px solid #ccc;">
            </div>
            <div style="width: 400px; margin-top: 20px;">
                <label for="drop">Drop location:</label>
                <input type="text" id="drop" placeholder="Enter a location" class="location-input" formControlName="dropLocation"
                    style="width: 100%; padding: 10px; box-sizing: border-box; border-radius: 4px; border: 1px solid #ccc;">
            </div>
            <div style="display: flex; margin-top: 20px;width: 400px;">
                <div>
                    <label for="startDate">Start Date:</label>
                    <!-- <input type="datetime-local" id="startDate" name="startDate" [value]="startDate" /> -->
                    <input type="text" id="startDate" name="startDate" placeholder="Enter a location"
                        class="location-input" (click)="openPicker(pickerModal)" formControlName="pickupDateTime"
                        value="{{this.selectedFromFormattedRange}}"
                        style="width: 100%; padding: 10px; box-sizing: border-box; border-radius: 4px; border: 1px solid #ccc;"
                         readonly>
                </div>
                <div>
                    <label for="endDate">End Date:</label>
                    <!-- <input type="datetime-local" id="endDate" name="endDate" [value]="endDate" /> -->
                    <input type="text" id="endDate" name="endDate" placeholder="Enter a location" class="location-input"
                        (click)="openPicker(pickerModal)" value="{{this.selectedToFormattedRange}}" formControlName="dropDateTime" 
                        style="width: 100%; padding: 10px; box-sizing: border-box; border-radius: 4px; border: 1px solid #ccc;"
                         readonly>
                </div>
            </div>
            <div>
                <button class="btn btn-primary mt-3" style="width: 400px;" (click)="goToSearchResults()">
                    Submit
                </button>
            </div>
        </form>
    </div>

</div>
<button (click)="onUseCurrentLocation()">üìç Use Current Location</button>
<p *ngIf="currentLocationName">Your Location: <strong>{{ currentLocationName }}</strong></p>
<ul *ngIf="distanceResults.length > 0">
    <li *ngFor="let result of distanceResults">
        {{ result.destination }} ‚Äì {{ result.distance }} ({{ result.duration }})
    </li>
</ul>
<div style="width: 100%; height: 500px;">
    <!-- <button class="btn btn-primary" (click)="openPicker(pickerModal)">
        <i class="bi bi-calendar-date"></i> Select Date & Time Range
    </button> -->

    <!-- Display selected range -->
    <!-- <div *ngIf="selectedRange" class="alert alert-info mt-3">
        <strong>Selected:</strong> {{ selectedRange }}
    </div> -->

    <ng-template #pickerModal let-modal>
        <div class="modal-header bg-primary text-white">
            <h5 class="modal-title">Select Trip Date & Time</h5>
            <button type="button" class="btn-close btn-close-white" (click)="modal.dismiss()"></button>
        </div>

        <div class="modal-body">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <!-- Two months side by side -->
                <ngb-datepicker #dp [displayMonths]="2" [dayTemplate]="t" outsideDays="hidden"
                    (dateSelect)="onDateSelection($event)"
                    [startDate]="fromDate || {year: today.getFullYear(), month: today.getMonth()+1}"
                    [markDisabled]="isDisabled">
                </ngb-datepicker>
            </div>

            <ng-template #t let-date let-focused="focused">
                <span class="custom-day" [class.focused]="focused" [class.range]="isRange(date)"
                    [class.filled]="isInside(date)" [class.start]="isFrom(date)" [class.end]="isTo(date)"
                    [class.invalid]="isInvalid(date)">
                    {{ date.day }}
                </span>
            </ng-template>

            <!-- Time Pickers -->
            <div class="row mt-4">
                <div class="col-md-6">
                    <label class="fw-bold">From Time</label>
                    <ngb-timepicker [(ngModel)]="fromTime" [meridian]="true"></ngb-timepicker>
                </div>
                <div class="col-md-6">
                    <label class="fw-bold">To Time</label>
                    <ngb-timepicker [(ngModel)]="toTime" [meridian]="true"></ngb-timepicker>
                </div>
            </div>

            <!-- Validation error -->
            <div *ngIf="validationError" class="alert alert-danger mt-3">
                {{ validationError }}
            </div>
        </div>

        <div class="modal-footer">
            <button class="btn btn-outline-secondary" (click)="modal.dismiss()">Cancel</button>
            <button class="btn btn-success" [disabled]="validationError !== ''"
                (click)="applySelection(modal)">Apply</button>
        </div>
    </ng-template>
</div>